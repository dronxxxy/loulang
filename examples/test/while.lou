const putChar = @externFun("putchar", @procFun(u8))

const putCString = fun (cstr: @ptr(u8)) {
  var i = -1
  while @ptrAt(cstr, i += 1) != '\0' {
    putChar(@ptrAt(cstr, i))
  }
}

const putInt = fun (var int: i32) {
  if int < 0 {
    int = -int
    putChar('-')
  } else if int == 0 {
    putChar('0')
    return
  }

  const BufferSize = 16
  var buffer: @array(BufferSize, u8)
  
  var length = 0
  while int > 0 {
    @arrayAt(buffer, length) = '0' + @intCast(int % 10, u8)
    int /= 10
    length += 1
  }

  while length > 0 {
    putChar(@arrayAt(buffer, length = length - 1))
  }
}

@global("main", fun () -> i32 {
  const Range = 10
  var i = -Range - 1
  
  putCString(c"[")
  while i += 1 <= Range {
    if i != -Range {
      putCString(c", ")
    }
    putInt(i * 1)
  }
  putCString(c"]\n")

  return 0
})


